<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jogo da Mem√≥ria</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --card-back-color: #6366f1;
            --game-bg: #eef2ff;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--game-bg);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            max-width: 90%;
            width: 100%;
        }

        /* CARD STYLING */
        .game-grid {
            display: grid;
            gap: 10px;
            margin-top: 20px;
            width: 100%;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }

        .card-container {
            perspective: 1000px;
            aspect-ratio: 1 / 1; /* Garante que a carta seja quadrada */
        }

        .card {
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* Efeito de flip mais suave */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            cursor: pointer;
            position: relative;
        }

        .card.flipped {
            transform: rotateY(180deg);
            pointer-events: none; /* Desabilita clique na carta virada */
        }

        .card.matched {
            box-shadow: 0 0 15px var(--primary-color);
            border: 2px solid var(--primary-color);
            opacity: 0.8;
            pointer-events: none; /* Desabilita clique na carta combinada */
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: clamp(1.5rem, 5vw, 4rem); /* Tamanho de fonte responsivo */
            font-weight: 900;
        }

        .card-back {
            background-color: var(--card-back-color);
            color: white;
            /* Adicionar um padr√£o visual simples ao verso */
            background-image: linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0.1) 75%, transparent 75%, transparent);
            background-size: 15px 15px;
        }

        .card-front {
            background-color: #ffffff;
            color: #333;
            transform: rotateY(180deg);
            padding: 5px; /* Espa√ßamento interno para as imagens/emojis */
            overflow: hidden;
        }
        
        .card-front img, .card-front svg {
            max-width: 90%;
            max-height: 90%;
            object-fit: contain;
        }

        /* Layout Grid Responsivo */
        .grid-4x4 { grid-template-columns: repeat(4, 1fr); }
        .grid-6x6 { grid-template-columns: repeat(6, 1fr); }
        .grid-8x8 { grid-template-columns: repeat(8, 1fr); }

        /* Estilo para a Tela Final */
        #end-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none; /* Inicialmente oculto */
            justify-content: center;
            align-items: center;
            z-index: 100;
        }

        .end-content {
            background: white;
            padding: 40px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 0 50px rgba(79, 70, 229, 0.7);
            max-width: 90%;
            width: 400px;
        }

        /* Bot√µes */
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: bold;
            transition: background-color 0.2s, transform 0.1s;
        }
        .btn-primary:hover {
            background-color: #4338ca;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- TELA INICIAL (MENU PRINCIPAL) -->
        <div id="menu-screen" class="p-6">
            <h1 class="text-4xl font-black text-center mb-8 text-indigo-700">Jogo da Mem√≥ria</h1>
            
            <div class="space-y-6 max-w-sm mx-auto">
                
                <!-- SELETOR DE DIFICULDADE -->
                <div>
                    <label for="difficulty" class="block text-lg font-semibold text-gray-700 mb-2">N√≠vel de Dificuldade:</label>
                    <select id="difficulty" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm">
                        <option value="easy">F√°cil (4x4)</option>
                        <option value="medium" selected>Normal (6x6)</option>
                        <option value="hard">Dif√≠cil (8x8)</option>
                    </select>
                </div>
                
                <!-- SELETOR DE TEMA -->
                <div>
                    <label for="theme" class="block text-lg font-semibold text-gray-700 mb-2">Tema das Cartas:</label>
                    <select id="theme" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm">
                        <option value="disney">Personagens (Disney)</option>
                        <option value="animals" selected>Animais</option>
                        <option value="pokemon">Pok√©mon</option>
                        <option value="fruits">Frutas</option>
                        <option value="food">Comidas</option>
                    </select>
                </div>

                <!-- BOT√ÉO INICIAR -->
                <button onclick="initializeGame()" class="btn-primary w-full text-xl mt-8 shadow-lg hover:shadow-xl">
                    <i class="fas fa-play mr-2"></i> Iniciar Jogo
                </button>
            </div>
        </div>

        <!-- TELA DO JOGO -->
        <div id="game-screen" class="hidden">
            <div class="flex justify-between items-center mb-6 p-4 bg-indigo-100 rounded-lg shadow-inner">
                <div class="text-lg font-bold text-indigo-800">
                    Movimentos: <span id="moves-counter">0</span>
                </div>
                <h2 class="text-2xl font-black text-indigo-700">Jogo da Mem√≥ria</h2>
                <div class="text-lg font-bold text-indigo-800">
                    Tempo: <span id="timer">00:00</span>
                </div>
            </div>
            
            <div id="game-grid" class="game-grid">
                <!-- Cartas ser√£o injetadas aqui -->
            </div>
            
            <div class="text-center mt-6">
                 <button onclick="showMenu()" class="btn-primary bg-gray-500 hover:bg-gray-600">
                    <i class="fas fa-undo mr-2"></i> Voltar ao Menu
                </button>
            </div>
        </div>
    </div>
    
    <!-- TELA DE FIM DE JOGO -->
    <div id="end-screen">
        <div class="end-content">
            <h3 class="text-5xl font-extrabold text-indigo-600 mb-4">üéâ Parab√©ns! üéâ</h3>
            <p class="text-xl text-gray-700 mb-6">Voc√™ encontrou todos os pares!</p>
            
            <div class="space-y-3 mb-8">
                <div class="text-2xl font-bold text-gray-800">
                    Total de Movimentos: <span id="final-moves" class="text-indigo-600"></span>
                </div>
                <div class="text-2xl font-bold text-gray-800">
                    Tempo Total: <span id="final-time" class="text-indigo-600"></span>
                </div>
            </div>

            <button onclick="showMenu()" class="btn-primary w-full text-xl">
                Novo Jogo
            </button>
        </div>
    </div>

    <script>
        // Vari√°veis Globais de Estado
        let gameActive = false;
        let difficulty = 'medium';
        let theme = 'animals';
        let gridSize = 36; // 6x6 padr√£o
        let cardsArray = [];
        let firstCard = null;
        let secondCard = null;
        let lockBoard = false;
        let moves = 0;
        let matchesFound = 0;
        let totalMatches = 0;
        let timerInterval = null;
        let startTime = 0;

        // Mapeamento de Dificuldade para Tamanho da Grade
        const GRID_SIZES = {
            'easy': { size: 16, pairs: 8, css: 'grid-4x4' }, // 4x4
            'medium': { size: 36, pairs: 18, css: 'grid-6x6' }, // 6x6
            'hard': { size: 64, pairs: 32, css: 'grid-8x8' }  // 8x8
        };

        // Dados dos Temas (Usando Emojis/SVGs como Conte√∫do)
        // DICA: O usu√°rio pode facilmente substituir por URLs de imagens aqui!
        const THEMES = {
            disney: [
                'üê≠', 'üëë', 'ü¶Å', '‚ùÑÔ∏è', 'üßú‚Äç‚ôÄÔ∏è', 'üêª', 'üï∞Ô∏è', 'üêò', // Exemplo Emojis Disney
                'Ariel', 'Elsa', 'Simba', 'Margarida', 'Moana', 'Woody', 'Buzz', 'Pooh'
            ],
            animals: [
                'ü¶Å', 'üêò', 'üê¨', 'ü¶í', 'ü¶ì', 'üêß', 'üêÖ', 'üêº', 
                'üêí', 'üêá', 'üêï', 'üêà', 'ü¶ú', 'ü¶â', 'ü¶å', 'üê∏', 
                'üêç', 'üê¢', 'ü¶¢', 'ü¶è', 'ü¶î', 'ü¶ô', 'ü¶°', 'ü¶á', 
                'ü¶Ö', 'ü¶à', 'ü¶Ä', 'üê≥', 'üêå', 'ü¶ã', 'üêù', 'üêú'
            ],
            pokemon: [
                'Pika', 'Char', 'Bulba', 'Squir', 'Jiggly', 'Mew', 'Eeve', 'Snor', 
                'Psy', 'Gengar', 'Toge', 'Magik', 'Vulpix', 'Zubat', 'Machop', 'Onix',
                'Chan', 'Rhydon', 'Scyther', 'Lapras', 'Ditto', 'Aerod', 'Dratini', 'Artic',
                'Zapdos', 'Moltres', 'Ho-Oh', 'Lugia', 'Celebi', 'Treecko', 'Torchic', 'Mudkip'
            ],
            fruits: [
                'üçé', 'üçå', 'üçì', 'üçá', 'üçä', 'üçç', 'ü•ù', 'ü•≠', 
                'üçí', 'üçâ', 'üçë', 'üçê', 'ü••', 'üçã', 'ü•ë', 'ü´ê', 
                'üçà', 'üå∂Ô∏è', 'üçÜ', 'ü•¶', 'ü•ï', 'ü•î', 'üßÖ', 'üåΩ', 
                'üçÑ', 'üå∞', 'ü•ú', 'üåæ', 'üå±', 'üåø', 'üçÉ', 'üçÄ'
            ],
            food: [
                'üçï', 'üçî', 'üç£', 'üåÆ', 'üçü', 'üç©', 'üç™', 'üç∞', 
                'ü•ê', 'ü•®', 'üçú', 'üçù', 'üçö', 'üçó', 'ü•©', 'ü•ì',
                'ü•û', 'üßá', 'ü•™', 'ü•ô', 'üåØ', 'üßÜ', 'ü•ö', 'ü•õ',
                '‚òï', 'üçµ', 'üçª', 'üç∑', 'üç∏', 'üçπ', 'üßâ', 'üçæ'
            ]
        };

        // --- Fun√ß√µes de Utilit√°rio ---

        /**
         * Embaralha um array usando o algoritmo Fisher-Yates.
         * @param {Array} array
         */
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * Formata o tempo em minutos e segundos (MM:SS).
         * @param {number} totalSeconds
         */
        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // --- Fun√ß√µes de Interface/Fluxo ---

        /**
         * Exibe a tela de menu e oculta a tela de jogo/fim.
         */
        function showMenu() {
            document.getElementById('menu-screen').classList.remove('hidden');
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('end-screen').style.display = 'none';

            // Para o temporizador se estiver rodando
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        /**
         * Inicia a contagem do tempo.
         */
        function startTimer() {
            startTime = Date.now();
            const timerElement = document.getElementById('timer');
            timerElement.textContent = '00:00';

            if (timerInterval) clearInterval(timerInterval);

            timerInterval = setInterval(() => {
                const elapsedSeconds = Math.floor((Date.now() - startTime) / 1000);
                timerElement.textContent = formatTime(elapsedSeconds);
            }, 1000);
        }

        /**
         * Prepara e inicia o jogo a partir das configura√ß√µes do menu.
         */
        function initializeGame() {
            // 1. Coleta das configura√ß√µes
            difficulty = document.getElementById('difficulty').value;
            theme = document.getElementById('theme').value;
            
            // 2. Define o tamanho da grade e o n√∫mero de pares
            const settings = GRID_SIZES[difficulty];
            gridSize = settings.size;
            totalMatches = settings.pairs;

            // 3. Oculta o menu e mostra a tela de jogo
            document.getElementById('menu-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');

            // 4. Limpa e reinicia as estat√≠sticas
            resetGame();
            
            // 5. Gera e renderiza as cartas
            generateCards(settings.css);

            // 6. Inicia o temporizador
            startTimer();
            gameActive = true;
        }

        /**
         * Reinicia o estado das vari√°veis do jogo.
         */
        function resetGame() {
            firstCard = null;
            secondCard = null;
            lockBoard = false;
            moves = 0;
            matchesFound = 0;
            document.getElementById('moves-counter').textContent = moves;
        }

        /**
         * Gera e renderiza as cartas no DOM.
         * @param {string} cssGridClass Classe CSS para a grade (ex: grid-4x4)
         */
        function generateCards(cssGridClass) {
            const gridElement = document.getElementById('game-grid');
            gridElement.innerHTML = '';
            
            // Define a classe CSS da grade
            gridElement.className = `game-grid ${cssGridClass}`;

            // 1. Seleciona o conte√∫do das cartas (pares)
            const themeContent = THEMES[theme];
            
            // Pega apenas o n√∫mero de pares necess√°rio, e duplica
            const requiredContent = themeContent.slice(0, totalMatches);
            cardsArray = [...requiredContent, ...requiredContent];
            
            // 2. Embaralha o array de cartas
            shuffle(cardsArray);

            // 3. Cria os elementos HTML para cada carta
            cardsArray.forEach((content, index) => {
                const cardContainer = document.createElement('div');
                cardContainer.classList.add('card-container');
                
                const card = document.createElement('div');
                card.classList.add('card');
                card.dataset.cardContent = content; // Armazena o valor do par
                card.onclick = handleCardClick;

                // Verso da carta
                const cardBack = document.createElement('div');
                cardBack.classList.add('card-face', 'card-back');
                cardBack.innerHTML = `<i class="fas fa-question text-3xl"></i>`; // √çcone de interroga√ß√£o no verso

                // Frente da carta (Conte√∫do)
                const cardFront = document.createElement('div');
                cardFront.classList.add('card-face', 'card-front');
                
                // --- INSTRU√á√ïES PARA IMAGENS (SOLICITA√á√ÉO DO USU√ÅRIO) ---
                /*
                Se o usu√°rio quiser usar imagens, ele pode substituir a linha abaixo (cardFront.textContent = content)
                pelo seguinte bloco de c√≥digo. Ele precisaria ter um objeto de mapeamento
                (ex: IMAGE_MAP['Mickey'] = 'url-da-imagem-mickey.png').
                
                const cardContent = themeContent[index]; // Ou use um mapeamento de URL
                
                if (content.startsWith('http') || content.endsWith('.png') || content.endsWith('.jpg')) {
                    // Se o conte√∫do for uma URL de imagem
                    cardFront.innerHTML = `<img src="${content}" alt="Carta ${index}" class="rounded-lg object-contain">`;
                } else {
                    // Mant√©m emojis/texto
                    cardFront.textContent = content;
                }
                */
                // Usando Emojis/Texto simples por padr√£o:
                IMAGE_MAP['Margarida'] = 'https://tse1.mm.bing.net/th/id/OIP.gDw8CrDDJ8eP9_cG-X6LmwHaJn?rs=1&pid=ImgDetMain&o=7&rm=3');
                // --- FIM DAS INSTRU√á√ïES PARA IMAGENS ---


                card.appendChild(cardBack);
                card.appendChild(cardFront);
                cardContainer.appendChild(card);
                gridElement.appendChild(cardContainer);
            });
        }

        // --- L√≥gica do Jogo ---

        /**
         * Lida com o clique em uma carta.
         * @param {Event} e 
         */
        function handleCardClick(e) {
            if (!gameActive || lockBoard) return;

            // Encontra o elemento '.card' (o que tem o efeito de flip)
            const clickedCard = e.currentTarget;

            // Ignora se for a mesma carta j√° virada ou uma j√° combinada
            if (clickedCard === firstCard || clickedCard.classList.contains('flipped')) return;

            clickedCard.classList.add('flipped');

            if (!firstCard) {
                // Primeira carta virada
                firstCard = clickedCard;
            } else {
                // Segunda carta virada
                secondCard = clickedCard;
                moves++;
                document.getElementById('moves-counter').textContent = moves;

                lockBoard = true; // Bloqueia o tabuleiro temporariamente
                checkMatch();
            }
        }

        /**
         * Verifica se as duas cartas viradas s√£o um par.
         */
        function checkMatch() {
            const isMatch = firstCard.dataset.cardContent === secondCard.dataset.cardContent;

            if (isMatch) {
                disableCards();
            } else {
                unflipCards();
            }
        }

        /**
         * A√ß√£o de acerto: Mant√©m as cartas viradas e as desabilita.
         */
        function disableCards() {
            matchesFound++;
            
            // Aplica estilo de 'combinado'
            firstCard.classList.add('matched');
            secondCard.classList.add('matched');

            // Cartas permanecem viradas (flipped) e desabilitadas (pointer-events: none no CSS)
            resetBoard();

            if (matchesFound === totalMatches) {
                endGame();
            }
        }

        /**
         * A√ß√£o de erro: Vira as cartas para baixo novamente ap√≥s um atraso.
         */
        function unflipCards() {
            setTimeout(() => {
                firstCard.classList.remove('flipped');
                secondCard.classList.remove('flipped');
                resetBoard();
            }, 1000); // 1 segundo de atraso
        }

        /**
         * Reinicia as vari√°veis de rastreamento do tabuleiro.
         */
        function resetBoard() {
            [firstCard, secondCard, lockBoard] = [null, null, false];
        }

        /**
         * Lida com o fim do jogo (todos os pares encontrados).
         */
        function endGame() {
            gameActive = false;
            
            // Para o temporizador
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }

            const finalSeconds = Math.floor((Date.now() - startTime) / 1000);

            // Atualiza a tela de fim de jogo
            document.getElementById('final-moves').textContent = moves;
            document.getElementById('final-time').textContent = formatTime(finalSeconds);
            document.getElementById('end-screen').style.display = 'flex';
        }

        // Garante que o menu seja exibido ao carregar
        window.onload = showMenu;

    </script>
</body>
</html>
